<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Создание кинозала</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="/admin/dashboard">Кинотеатр Админ</a>
    <a href="/admin/halls" class="btn btn-secondary">Назад к залам</a>
  </div>
</nav>

<div class="container mt-4">
  <h2>Создание нового кинозала</h2>

  <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

  <div class="card mt-4">
    <div class="card-body">
      <form method="post" action="/admin/halls" id="hallForm">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
        <div class="mb-3">
          <label class="form-label">Название зала *</label>
          <input type="text" class="form-control" name="name" required
                 placeholder="Например: Зал 1, Большой зал, IMAX">
        </div>

        <div class="mb-3">
          <label class="form-label">Описание</label>
          <textarea class="form-control" name="description" rows="3"
                    placeholder="Описание зала, особенности..."></textarea>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <label class="form-label">Количество рядов *</label>
            <input type="number" class="form-control" name="rowsCount" id="rowsCount"
                   min="1" max="30" value="10" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">Мест в ряду *</label>
            <input type="number" class="form-control" name="seatsPerRow" id="seatsPerRow"
                   min="1" max="30" value="15" required>
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label">Вместимость</label>
          <input type="number" class="form-control" name="capacity" id="capacity"
                 readonly placeholder="Автоматически рассчитывается">
          <small class="text-muted">Автоматически рассчитывается (ряды × места)</small>
        </div>

        <div class="mb-3">
          <label class="form-label">Тип зала</label>
          <select class="form-select" name="hallType">
            <option value="STANDARD">Стандартный</option>
            <option value="VIP">VIP</option>
            <option value="IMAX">IMAX</option>
            <option value="3D">3D</option>
          </select>
        </div>

        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-success">Создать зал</button>
          <a href="/admin/halls" class="btn btn-secondary">Отмена</a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Функция для расчета вместимости
  function calculateCapacity() {
    const rows = parseInt(document.getElementById('rowsCount').value) || 0;
    const seatsPerRow = parseInt(document.getElementById('seatsPerRow').value) || 0;
    const capacity = rows * seatsPerRow;

    document.getElementById('capacity').value = capacity;
  }

  // Вызываем функцию при загрузке страницы
  document.addEventListener('DOMContentLoaded', calculateCapacity);

  // Добавляем обработчики событий на изменение значений
  document.getElementById('rowsCount').addEventListener('input', calculateCapacity);
  document.getElementById('seatsPerRow').addEventListener('input', calculateCapacity);

  // Также можно добавить обработчик на отправку формы для дополнительной проверки
  document.getElementById('hallForm').addEventListener('submit', function(e) {
    // Можно добавить дополнительную логику здесь при необходимости
    calculateCapacity(); // Убедимся, что значение рассчитано перед отправкой
  });
</script>
</body>
</html>